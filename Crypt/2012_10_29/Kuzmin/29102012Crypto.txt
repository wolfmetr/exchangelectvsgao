Режимы шифрования блочных шифров.
Режим CBC(Chipger Block Chaining)

E,D - без-ный PRP
IV from X
Есть множество открытых текстов m0,m1,...,mn и вектор инициализации
import image here 20121029_1Crypto
Теорема.
Если E - безопасный PRP над (к,х), тогда для любого L > 0 E_cbc - семантические стойкий шифр для CPA над(k,X^L,X^(L+1))
А - противник, атакующий E_cbc, посылающий q запросов. Тогда, мы сможем построить противника B,атакующего шифр E, что выполняется следующее условие:
Adv_cpa[A,E_cbc] <=Adv_prp[B,E] + (q^2L^2)/|x| q^2*l^2<<|x|
#AES 128 бит |x| = 2^128
Adv_cpa[A,E_cbc] < 2^-32

q^2*L^2/2^128 < 2^-32

q^2*L^2<2^96

qL < 2^48

Утверждение. Если противник предсказывает вектор инициализации, то режим шифрования E_cbc не является семантически безопасным для CPA
ШТ - IV => IV для следующего
import image here 20121029_2Crypto

Версия CBC для одноразового шифрования
nonce
Зашифруем nonce на ключе k1
import image here 20121029_3Crypto.png

Особенности реализации режима
Размер блока 128 бит
длина ОТ 200 бит
Используем padding
128бит   72бит 56бит
  m1	 m2 || pad
 В качестве pad будет добавлено n раз по n байт
 TLS
 
 Режим шифрования CTR(Randomize Counter Mode)
 ]F_без PRF F:k x {0,1}^n -> {0,1}^n
 Шифрование:
 случ. IV				 m_0				 m_1					m_2
					   F(k,IV)			  F(k,IV+1)				F(k,IV + 2)
	IV				   	 c_0				 c_1				 	c_2
Дешифрование:
c_i = F(k,IV + i) xor m_i
m_i = F(k,IV + I) xor c_i
Теорема. Если F - беззнаковая PRF над(k,x,x), тогда для любого L>0
E_ctr - сем-ки без-ый шифр для CPA над (k,X^L,X^(L+1))
Adv_cpa[A,E_ctr] <= 2Adv_prf[B,F] + 2q^2L/|x|
Обе величины должны быть незначимыми(q^2L<<|x|)
#Adv_cpaa[A,E_ctr] < 2^-32
q*L^1/2 < 2^48
